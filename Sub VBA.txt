Sub VBA_Challenge()    'Loop Through each WorksheetFor Each ws In Worksheets    'Variables    Dim Row As Integer    Row = 2    Dim Column As Integer    Column = 9        Dim Ticker As String    Dim Volume As Double    Volume = 0        Dim Open_Price As Double    Open_Price = ws.Cells(2, 3).Value    Dim Close_Price As Double    Dim Delta As Double                'Create Headers    ws.Cells(1, Column).Value = "Ticker"    ws.Cells(1, Column + 1).Value = "Yearly Change"    ws.Cells(1, Column + 2).Value = "Percent Change"    ws.Cells(1, Column + 3).Value = "Total Stock Volume"        'Set Format    ws.Columns(Column + 1).NumberFormat = "$#,##0.00"    ws.Columns(Column + 2).NumberFormat = "0.00%"    ws.Columns(Column + 3).NumberFormat = "0,000"       'Get Last Row    Last_Row = Cells(Rows.Count, 1).End(xlUp).Row        'Loop Through Rows    For i = 2 To Last_Row            If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then            'get ticker                Ticker = ws.Cells(i, 1).Value            'get volume                Volume = Volume + ws.Cells(i, 7).Value            'get closing price                Close_Price = ws.Cells(i, 6).Value            'calculate dollar change                Delta = Close_Price - Open_Price                        'Output results                ws.Cells(Row, Column).Value = Ticker                ws.Cells(Row, Column + 1).Value = Delta                ws.Cells(Row, Column + 2).Value = Delta / (Open_Price + 1E-05)                ws.Cells(Row, Column + 3).Value = Volume                            'Go to next row in output column                Row = Row + 1                            'Reset variables                Volume = 0                'Get Open Price for next Ticker                Open_Price = ws.Cells(i + 1, 3).Value                            Else                Volume = Volume + ws.Cells(i, 7).Value                'If stock wasn't available at the beginning of the year, use first date stock was available                If Open_Price = 0 Then                    Open_Price = ws.Cells(i, 3).Value                End If                        End If                Next i        'Conditional Formatting    Dim rg As Range    Dim cond_gain1 As FormatCondition    Dim cond_loss As FormatCondition    Set rg = ws.Range("J2", ws.Range("J2").End(xlDown))        'clear exisitng formatting    rg.FormatConditions.Delete        Set cond_gain = rg.FormatConditions.Add(xlCellValue, xlGreaterEqual, 0)    Set cond_loss = rg.FormatConditions.Add(xlCellValue, xlLess, 0)        With cond_gain    .Interior.Color = vbGreen    End With        With cond_loss    .Interior.Color = vbRed    End With   Next wsEnd Sub